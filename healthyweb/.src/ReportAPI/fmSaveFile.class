' Gambas class file

Private $sFIle As String
Private $encid As String

Public Sub _new(sPath As String, encid As String)

  $sFIle = sPath
  $encid = encid

  txtfile.ProgressControl = WebProgressBar1
  txtfile.Text = File.Name($sFIle)
  If $encid Then
    rbarchive.Value = True
  Else
    rbarchive.Enabled = False
    rbpersonal.Value = True
  Endif
  txtdetail.SetFocus

End

Public Sub btnsend_Click()

  If rbpersonal.Value = True Then
    SaveToPersonal()
  Else If rbarchive.Value = True Then
    SaveToArchive()
  Endif
  Me.Exec("Toastify({text: 'Information saved', duration: 3000}).showToast()")

End

Private Sub SaveToPersonal()

  If txtdetail.Text Then
    modImage.SaveDocumentToPersonal(modBasic.$lbluser, txtdetail.Text, $sFIle)
  Endif

End

Private Sub SaveToArchive()

  Dim sLongID As Long

  sLongID = modImage.SavePatientFileGeneral($encid, "General Reports", txtdetail.Text, $sFIle, False, modReportVar.$ReportHash)                  ''

End

Public Sub btnclose_Click()

  Me.Close

End
