' Gambas class file

Export
Inherits WebContainer

Public Const _IsContainer As Boolean = False
Public Const _Properties As String = "*,RichText,Text,KeyList,PlaceHolder"

Property Text As String
Property RichText As String
Property KeyList As String[]
Property PlaceHolder As String

Private hTopBox As WebContainer
Private TextEdit1 As WebRichText
Private WebContainer1 As WebScrollView

' Private btnComplete As WebButton
Private btnBold As WebButton
Private btnItalic As WebButton
Private btnUnderline As WebButton
Private btnStrikeOut As WebButton
Private btnAlignLeft As WebButton
Private btnAlignCenter As WebButton
Private btnAlignRight As WebButton
Private btnAlignJustify As WebButton
Private btnindent As WebButton
Private btnoutdent As WebButton
Private btnlistOrder As WebButton
Private btnlistunorder As WebButton
Private btnsubscript As WebButton
Private btnsuperscript As WebButton

Public Sub _new()

  Me.Arrangement = Arrange.Vertical

  hTopBox = New WebContainer(Me)
  hTopBox.Arrangement = Arrange.Row

  ' btnComplete = New WebButton(hBox) As "btnComplete"
  ' btnComplete.Immediate = True
  ' btnComplete.Height = "2em"
  ' btnComplete.Width = "2em"
  ' btnComplete.Image = "icon:/small/exec"

  ''format buttons
  btnBold = New WebButton(hTopBox) As "btnBold"
  btnBold.Image = "icon:/small/text-bold"
  FormatButton(btnBold, "Bold")

  btnItalic = New WebButton(hTopBox) As "btnItalic"
  btnItalic.Image = "icon:/small/text-italic"
  FormatButton(btnItalic, "Italic")

  btnUnderline = New WebButton(hTopBox) As "btnUnderline"
  btnUnderline.Image = "icon:/small/text-underline"
  FormatButton(btnUnderline, "Underline")

  btnStrikeOut = New WebButton(hTopBox) As "btnStrikeOut"
  btnStrikeOut.Image = "icon:/small/text-strike"
  FormatButton(btnStrikeOut, "StrikeOut")

  btnAlignLeft = New WebButton(hTopBox) As "btnAlignLeft"
  btnAlignLeft.Image = "icon:/small/text-left"
  FormatButton(btnAlignLeft, "Align Left")

  btnAlignCenter = New WebButton(hTopBox) As "btnAlignCenter"
  btnAlignCenter.Image = "icon:/small/text-center"
  FormatButton(btnAlignCenter, "Align Center")

  btnAlignRight = New WebButton(hTopBox) As "btnAlignRight"
  btnAlignRight.Image = "icon:/small/text-right"
  FormatButton(btnAlignRight, "Align Right")

  btnAlignJustify = New WebButton(hTopBox) As "btnAlignJustify"
  btnAlignJustify.Image = "icon:/small/text-fill"
  FormatButton(btnAlignJustify, "Align Justify")

  btnindent = New WebButton(hTopBox) As "btnindent"
  btnindent.Image = "icon:/small/indent"
  FormatButton(btnindent, "Indent")

  btnoutdent = New WebButton(hTopBox) As "btnoutdent"
  btnoutdent.Image = "icon:/small/unindent"
  FormatButton(btnoutdent, "Unindent")

  btnlistOrder = New WebButton(hTopBox) As "btnlistOrder"
  btnlistOrder.Image = "icons/coll1.png"
  FormatButton(btnlistOrder, "Ordered list")

  btnlistunorder = New WebButton(hTopBox) As "btnlistunorder"
  btnlistunorder.Image = "icons/coll2.png"
  FormatButton(btnlistunorder, "Unordered list")

  btnsubscript = New WebButton(hTopBox) As "btnsubscript"
  btnsubscript.Image = "icon:/small/sort-ascent"
  FormatButton(btnsubscript, "Subscript")

  btnsuperscript = New WebButton(hTopBox) As "btnsuperscript"
  btnsuperscript.Image = "icon:/small/sort-descent"
  FormatButton(btnsuperscript, "Superscript")

  ''Main control
  WebContainer1 = New WebScrollView(Me)
  WebContainer1.Class = "test-autocomplete-container"
  WebContainer1.Expand = True
  WebContainer1.Border = True

  TextEdit1 = New WebRichText(WebContainer1)
  TextEdit1.Class = "dotted-control"
  TextEdit1.Expand = True

End

Private Sub FormatButton(xButton As WebButton, sToolTip As String)

  xButton.Class = "toolButton"
  xButton.Height = "2em"
  xButton.Width = "2em"
  xButton.Tooltip = sToolTip
  xButton.Immediate = True

End

''========================= Functions ========================
Private Function Text_Read() As String

  Return TextEdit1.Html

End

Private Sub Text_Write(Value As String)

  TextEdit1.Html = Value

End

Private Function RichText_Read() As String

  Dim xx As String

  If Not Trim(TextEdit1.Html) Then
    xx = ""
  Else If Trim(TextEdit1.Html) = "<br>" Then
    xx = ""
  Else If Trim(TextEdit1.Html) = "<span><br></span>" Then
    xx = ""
  Else
    xx = TextEdit1.Html
  Endif
  Return xx

End

Private Sub RichText_Write(Value As String)

  TextEdit1.Html = Value

End

Private Function PlaceHolder_Read() As String

  Return TextEdit1.PlaceHolder

End

Private Sub PlaceHolder_Write(Value As String)

  TextEdit1.PlaceHolder = Value
  Me.Refresh

End

Private Function KeyList_Read() As String[]

  Dim xx As String[]

  xx = New String[]
  Return xx

End

Private Sub KeyList_Write(Value As String[])

  ''nothing

End

''----------------- Format buttons ---------------
' Public Sub btnComplete_Click()
'
'   WebForm.Exec("htmlautocomplete(" & JS(TextEdit1.Name) & ", " & JS(WebContainer1.Name) & ")")
'
' End

Public Sub btnBold_Click()

  WebForm.Exec("document.execCommand('bold', false, false)")

End

Public Sub btnItalic_Click()

  WebForm.Exec("document.execCommand('italic', false, false)")

End

Public Sub btnUnderline_Click()

  WebForm.Exec("document.execCommand('underline', false, false)")

End

Public Sub btnStrikeOut_Click()

  WebForm.Exec("document.execCommand('strikethrough', false, false)")

End

Public Sub btnAlignLeft_Click()

  WebForm.Exec("document.execCommand('justifyleft', false, false)")

End

Public Sub btnAlignCenter_Click()

  WebForm.Exec("document.execCommand('justifycenter', false, false)")

End

Public Sub btnAlignRight_Click()

  WebForm.Exec("document.execCommand('justifyright', false, false)")

End

Public Sub btnAlignJustify_Click()

  WebForm.Exec("document.execCommand('justifyfull', false, false)")

End

Public Sub btnindent_Click()

  WebForm.Exec("document.execCommand('indent', false, false)")

End

Public Sub btnoutdent_Click()

  WebForm.Exec("document.execCommand('outdent', false, false)")

End

Public Sub btnlistOrder_Click()

  WebForm.Exec("document.execCommand('insertOrderedList', false, false)")

End

Public Sub btnlistunorder_Click()

  WebForm.Exec("document.execCommand('insertUnorderedList', false, false)")

End

Public Sub btnsubscript_Click()

  WebForm.Exec("document.execCommand('Subscript', false, false)")

End

Public Sub btnsuperscript_Click()

  WebForm.Exec("document.execCommand('Superscript', false, false)")

End
