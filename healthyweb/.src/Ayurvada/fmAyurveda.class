' Gambas class file

Public Sub _new()

  Me.AddHeader("<meta name='viewport' content='width=device-width, initial-scale=1'>")
  Me.AddHeader("<link rel=\"stylesheet\" href=\"" & modHelpVariable.$AppCssPath & "\">")
  Me.AddJavascriptFile("js/webcontrols.js")
  Me.AddJavascriptFile("js/jquery.min.js")
  Me.AddJavascriptFile("js/print.min.js")
  Me.AddJavascriptFile("js/toastify.js")
  Me.AddJavascriptFile("js/Chart.js")
  Me.AddJavascriptFile("js/tribute.js")
  Me.AddJavascriptFile("js/download.js")
  Me.AddJavascriptFile("js/select2.min.js")

  Me.AddJavascriptFile("js/sketchpad.js")
  ''slow js
  Me.AddJavascriptFile("js/html2pdf.bundle.min.js")
  Me.AddJavascriptFile("js/xlsx.full.min.js")
  Me.Font = MMain.$AppFontName
  WebImage1.Image = modHelpVariable.$headerImage
  mnucuruserid.Text = modBasic.$lbluser

End

Public Sub WebForm_Open()

  modHelpVariable.SetApplicationGUI()
  MMain.GetApplVersionType()

  modBasic.LoadClinicalChartSetting()
  modBasic.LoadClinicalLists()
  modBasic.ClinicalCommentSett()
  modBasic.LoadLabRadioList()
  modBasic.ChartSettingsAll()

  modBasic.LoadRegistrationSetting()
  modBasic.LoadCashierBillingSettings()
  modBasic.LoadInvoicingSetting()

  modLinkDB.LoadExtraDBSettings()
  If modBasic.$ExpoRepoUser = True Then
  Else
    modBasic.$PatNameFormat = "***SurName"
  Endif
  modAMISRep.$AyurvedicDiagnosis = modHelpVariable.$docsDirectory &/ "ayurvedicdisease.csv"

End

Public Sub mnuexit_Click()

  Session.Abandon()
  WebForm.Current = fmLogIn
  Me.Close()

End

Public Sub WebForm_Close()

  modDevice.CamOnClose()
  modDatabase.CloseDatabase()
  modExternal.DeleteFolderRecursive("/tmp" &/ modHelpVariable.AppName &/ "docs" &/ modHelpVariable.$SessionCode)
  modExternal.DeleteFolderRecursive(modHelpVariable.AppCacheDir)

End

Public Sub mnunewextra_Click()

  Dim xLink As String = "http://bitnepal.safiur.com.np/healthybit/help/" & modHelpVariable.$LogInCategory & "/"

  Me.Exec("window.open('" & xLink & "'); ")

End

Public Sub mnuclearcache_Click()

  modGeneralMain.CLearUserCollection()

End

Public Sub mnubugrepo_Click()

  modGeneralMain.SendBugReport(modBasic.$lbluser)

End

' Public Sub WebContainer2_Render()
'
'   Print "<iframe src='" & modBasic.$FormLeftURL & "' width='100%' height='100%'></iframe>";
'
' End
'
' Public Sub WebContainer3_Render()
'
'   Print "<iframe src='" & modBasic.$FormRightURL & "' width='100%' height='100%'></iframe>";
'
' End

Public Sub btnquit_Click()

  Session.Abandon()
  WebForm.Current = fmLogIn
  Me.Close()

End

Public Sub btnfullscreen_Click()

  If btnfullscreen.Image = "icon:/small/zoom-normal" Then
    btnfullscreen.Image = "icon:/small/zoom-fit"
    Me.Exec("openFullscreen()")

  Else If btnfullscreen.Image = "icon:/small/zoom-fit" Then
    btnfullscreen.Image = "icon:/small/zoom-normal"
    Me.Exec("closeFullscreen()")

  Endif

End

''================ Setting =================
Public Sub mnuchartset_Click()

  fmChartSetting.ShowModal

End

Public Sub mnureposetting_Click()

  fmReportSetting.ShowModal

End

Public Sub mnuappsetting_Click()

  fmAppSetting.ShowModal

End

''==================== Main Form ======================
' Public Sub mnuamis11_Click()
'
'   Dim hForm As FmAMISMaster
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmAMISMaster(Workspace1)
'
' End
'
' Public Sub mnuamis13_Click()
'
'   Dim hForm As FmAMISOPD
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmAMISOPD(Workspace1)
'
' End
'
' Public Sub mnuamis15_Click()
'
'   Dim hForm As FmAMISMedicine
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmAMISMedicine(Workspace1)
'
' End
'
' Public Sub mnuamis21_Click()
'
'   Dim hForm As FmAMISPanchkarma
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmAMISPanchkarma(Workspace1)
'
' End
'
' Public Sub mnuamis22_Click()
'
'   Dim hForm As FmAMISKsharsutra
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmAMISKsharsutra(Workspace1)
'
' End
'
' Public Sub mnuamis23_Click()
'
'   Dim hForm As FmAMISYoga
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmAMISYoga(Workspace1)
'
' End
'
' Public Sub mnuamis24_Click()
'
'   Dim hForm As FmAMISMother
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmAMISMother(Workspace1)
'
' End
'
' Public Sub mnuamis25_Click()
'
'   Dim hForm As FmAMISElderly
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmAMISElderly(Workspace1)
'
' End
'
' Public Sub mnuamis41_Click()
'
'   Dim hForm As FmAMISAdmission
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmAMISAdmission(Workspace1)
'
' End
'
' Public Sub mnuamis42_Click()
'
'   Dim hForm As FmAMISDischarge
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmAMISDischarge(Workspace1)
'
' End
'
' Public Sub mnuamis43_Click()
'
'   Dim hForm As FmAMISEmergency
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmAMISEmergency(Workspace1)
'
' End
'
' Public Sub mnuamis52_Click()
'
'   Dim hForm As FmAMISRepo
'
'   If Workspace1.Children.Count Then
'     Workspace1.DeleteChildren()
'   Endif
'   hForm = New FmAMISRepo(Workspace1)
'
' End

Public Sub mnualterdb_Click()

  modDHISTables.CreateDadaBaseDHIS(modDatabase.$myConn)
  If Message.Question("All tables collation will be changed to " & modHelpVariable.$SysCollation, ("No"), ("Yes")) = 2 Then
    modDatabase.MySQLSpecificCollation(modDatabase.$myConn)
  Endif
  Me.Exec("Toastify({text: 'Complete', duration: 3000}).showToast()")

End

Public Sub mnucuruserid_Click()

  Dim hForm As FmReportUsers

  If modBasic.$lbluser Then
    hForm = New FmReportUsers(modBasic.$lbluser)
    hForm.ShowModal
  Endif

End

Public Sub mnudarkmode_Click()

  Me.Exec("changeScreenMode();")

End
