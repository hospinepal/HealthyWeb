' Gambas class file

Private xchart As Chart
Private $encid As String
Private $sTitle As String
Private titles As String[]
Private strval As Float[]

Public Sub _new(encid As String, sTitle As String, dataXList As String[], dataYList As Float[])

  $encid = encid
  $sTitle = sTitle
  titles = dataXList
  strval = dataYList
  Me.Title = "ENC: " & $encid

End

Public Sub Form_Open()

  modGeneralMain.ArrangeEmbedForms(Me, Panel1, "Vertical")
  Me.Icon = Picture[modGeneralMain.$strLogo]
  modBasic.LoadClinicalChartSetting()

  xchart = modChart.GetInventoryChart($sTitle, titles, strval)
  grwchart.Cached = False
  xchart.Resize(grwchart.ClientWidth, grwchart.ClientHeight)

End

Public Sub Form_Close()

  modGeneralMain.RecordFormExit(Me)

End

Public Sub grwchart_Draw()

  Try xchart.Draw

End

Public Sub mnuexport_Click()

  ' Dim xx As String[]
  ' Dim xPath As String
  '
  ' xx = New String[]
  ' xx.Add($strItem)
  ' Inc Application.Busy
  ' xPath = modCHTMLPatient.ExportQuantiClinToHTML($encid, $strType, xx, $unt, Me)
  ' Dec Application.Busy
  ' modControlSub.OpenHTMLPreview($encid, xPath, "ReportSize")

End

Public Sub mnusave_Click()

  If Dialog.SelectDirectory() Then Return
  xchart.Picture.Save(Dialog.Path &/ modString.GetNowString() & ".png")

End
