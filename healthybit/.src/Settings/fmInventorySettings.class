' Gambas class file

Public Sub Form_Open()

  modGeneralMain.ArrangeFormCentre(Me)
  cmbskipexpiry.List = ["Expired", "ExpireOnUse", "None"]
  cmbsales.List = ["Manual", "FEFO"]
  cmbretrn.List = ["Manual", "FEFO"]
  cmbserialopen.List = ["Punching", "OnSave", "None"]
  cmbserialclose.List = ["OnSave", "FormClose", "None"]
  cmbautoup.List = ["Enable", "Disable"]
  cmbstockalert.List = ["UnderStock", "Expired", "Expire(1month)", "Expire(3month)"]

  ShowDefProfit()
  ShowGeneralSettings()
  ShowOutOrder()

End

Public Sub Form_Close()

  modGeneralMain.RecordFormExit(Me)

End

''-------------------------
Public Sub btnprofit_Click()

  modSettings.SaveSettingsToFile("DefaultProfit/Medicines", CStr(txtpromed.Value))
  modBasic.$MedProfit = txtpromed.Value
  modSettings.SaveSettingsToFile("DefaultProfit/Surgicals", CStr(txtprosurg.Value))
  modBasic.$SurgProfit = txtprosurg.Value
  Balloon.Info(("Information saved"), btnprofit)
  Balloon.Delay = modBasic.$BalloonDelay

End

Private Sub ShowDefProfit()

  If modSettings.ShowSettingFromFIle("DefaultProfit/Medicines") Then
    txtpromed.Value = CFloat(modSettings.ShowSettingFromFIle("DefaultProfit/Medicines"))
  Endif
  If modSettings.ShowSettingFromFIle("DefaultProfit/Surgicals") Then
    txtprosurg.Value = CFloat(modSettings.ShowSettingFromFIle("DefaultProfit/Surgicals"))
  Endif

End

''--------------------------------------------- out order --------------------------------------------------------
Private Sub ShowOutOrder()

  cmbautoup.Text = modSettings.ShowSettingFromFIle("InventorySetting/AutoOrderOnStartup")
  cmbsales.Text = modSettings.ShowSettingFromFIle("InventorySetting/SalesOutOrder")
  cmbretrn.Text = modSettings.ShowSettingFromFIle("InventorySetting/ReturnOutOrder")

End

Public Sub btnautoup_Click()

  modSettings.SaveSettingsToFile("InventorySetting/AutoOrderOnStartup", cmbautoup.Text)
  Balloon.Info(("Information saved"), btnautoup)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnsales_Click()

  modSettings.SaveSettingsToFile("InventorySetting/SalesOutOrder", cmbsales.Text)
  modBasic.$SalesOutOrder = cmbsales.Text
  Balloon.Info(("Information saved"), btnsales)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnretrn_Click()

  modSettings.SaveSettingsToFile("InventorySetting/ReturnOutOrder", cmbretrn.Text)
  modBasic.$RetnOutOrder = cmbretrn.Text
  Balloon.Info(("Information saved"), btnretrn)
  Balloon.Delay = modBasic.$BalloonDelay

End

''------------------------------------------------
Private Sub ShowGeneralSettings()

  cmbskipexpiry.Text = modSettings.ShowSettingFromFIle("InventorySetting/SkipExpiry")
  If modSettings.ShowSettingFromFIle("InventorySetting/PurchaseExpiry") Then
    txtlockpurchase.Value = CFloat(modSettings.ShowSettingFromFIle("InventorySetting/PurchaseExpiry"))
  Endif
  If modSettings.ShowSettingFromFIle("InventorySetting/ReturnExpiry") Then
    txtlockreturn.Value = CFloat(modSettings.ShowSettingFromFIle("InventorySetting/ReturnExpiry"))
  Endif
  cmbstockalert.Text = modSettings.ShowSettingFromFIle("InventorySetting/InventoryAlert")

  cmbserialopen.Text = modSettings.ShowSettingFromFIle("InventorySetting/ShowStorageLocation")
  cmbserialclose.Text = modSettings.ShowSettingFromFIle("InventorySetting/HideStorageLocation")

  txtfixedasset.Text = modSettings.ShowSettingFromFIle("FixedAssets/QRTemplete")

End

Public Sub btnskipexpiry_Click()

  modSettings.SaveSettingsToFile("InventorySetting/SkipExpiry", cmbskipexpiry.Text)
  modBasic.$SkipExpiry = cmbskipexpiry.Text
  Balloon.Info(("Information saved"), btnskipexpiry)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlockpurchase_Click()

  modSettings.SaveSettingsToFile("InventorySetting/PurchaseExpiry", txtlockpurchase.Value)
  Balloon.Info(("Information saved"), btnlockpurchase)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlockreturn_Click()

  modSettings.SaveSettingsToFile("InventorySetting/ReturnExpiry", txtlockreturn.Value)
  Balloon.Info(("Information saved"), btnlockreturn)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnserialopen_Click()

  modSettings.SaveSettingsToFile("InventorySetting/ShowStorageLocation", cmbserialopen.Text)
  modBasic.$ShowStorage = cmbserialopen.Text
  Balloon.Info(("Information saved"), btnserialopen)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnserialclose_Click()

  modSettings.SaveSettingsToFile("InventorySetting/HideStorageLocation", cmbserialclose.Text)
  modBasic.$HideStorage = cmbserialclose.Text
  Balloon.Info(("Information saved"), btnserialclose)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub txtfixedasset_Click()

  Dialog.Title = "Select QR Code templete for Fixed Assets"
  If Dialog.OpenFile() Then Return
  txtfixedasset.Text = Dialog.Path

End

Public Sub btnfixedasset_Click()

  modSettings.SaveSettingsToFile("FixedAssets/QRTemplete", txtfixedasset.Text)
  Balloon.Info(("Information saved"), btnfixedasset)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnstockalert_Click()

  modSettings.SaveSettingsToFile("InventorySetting/InventoryAlert", cmbstockalert.Text)
  Balloon.Info(("Information saved"), btnstockalert)
  Balloon.Delay = modBasic.$BalloonDelay

End
