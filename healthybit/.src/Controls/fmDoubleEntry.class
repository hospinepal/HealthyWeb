' Gambas class file

Private $Type As String

Public Sub _new(sType As String)

  $Type = sType
  If $Type = "Key Authorization" Then
    Me.Title = "Enter Keys"
    Label1.Text = "Key1"
    Label2.Text = "Key2"
  Endif

End

Public Sub Form_Open()

  modGeneralMain.ArrangeFormCentre(Me, "False")

End

Public Sub btncancel_Click()

  Me.Close

End

Public Sub btnok_Click()

  If $Type = "Key Authorization" Then
    EnterKeys()
  Endif

End

Private Sub EnterKeys()

  Dim res As Result
  Dim tbl As String

  If Application.Version Like "0.3." & "*" Then
    tbl = "tblkey"
  Else If Application.Version Like "1.3." & "*" Then
    tbl = "tblkey"
  Else
    tbl = "tblnewkey"
  Endif

  res = modDatabase.$myConn.Create(tbl)
  res["key1"] = txtstr1.Text
  res["key2"] = txtstr2.Text
  res.Update
  Balloon.Info(("Keys inserted"), btnok)
  Balloon.Delay = modBasic.$BalloonDelay

End
