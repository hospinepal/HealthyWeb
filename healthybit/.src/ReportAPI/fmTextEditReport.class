' Gambas class file

Private $txtbuttFile As ButtonBox

Public Sub _new(txtbuttFile As ButtonBox)

  $txtbuttFile = txtbuttFile
  If Exist($txtbuttFile.Text) Then
    TextEdit1.RichText = File.Load($txtbuttFile.Text)
    txtfolder.Text = File.Dir($txtbuttFile.Text)
    txtfile.Text = File.Name($txtbuttFile.Text)
  Endif

End

Public Sub Form_Open()

  modGeneralMain.ArrangeFormCentre(Me, "False")
  FillListView()

End

Public Sub txtfolder_Click()

  If Dialog.SelectDirectory() Then Return
  txtfolder.Text = Dialog.Path

End

Public Sub btnsave_Click()

  Dim newFile As String

  newFile = txtfolder.Text &/ txtfile.Text
  If Exist(newFile) Then
    Kill newFile
  Endif

  File.Save(newFile, TextEdit1.RichText)
  $txtbuttFile.Text = newFile
  Balloon.Info(("Template saved"), btnsave)
  Balloon.Delay = modBasic.$BalloonDelay

End

''========================= Variables =============================
Private Sub FillListView()

  ListView1.Add("a", "---General Param ---")
  ListView1.Add("{HospitalName}", "Hospital Name")
  ListView1.Add("{HospitalAddress}", "Hospital Address")
  ListView1.Add("{Department}", "Print Department")
  ListView1.Add("{HospLogo}", "Hospital Logo")
  ListView1.Add("{CurrentDate}", "Current Date")
  ListView1.Add("{CurrentTime}", "Current Time")
  ListView1.Add("{CurrentUser}", "Current User")
  ListView1.Add("{Footer1}", "Signature1")
  ListView1.Add("{Footer2}", "Signature2")
  ListView1.Add("{Footer3}", "Signature3")

  ListView1.Add("b", "---Patient Param ---")
  ListView1.Add("{Encounter}", "Encounter ID")
  ListView1.Add("{PatientNo}", "Patient No")
  ListView1.Add("{PatientCode}", "Patient Code")
  ListView1.Add("{PatientFileNo}", "Patient FileNo")
  ListView1.Add("{PatientName}", "Patient Name")
  ListView1.Add("{PatientEthnicity}", "Ethnic Group")
  ListView1.Add("{PatientMunicipality}", "Municipality")
  ListView1.Add("{PatientWardAddress}", "Ward Address")
  ListView1.Add("{PatientAddress}", "Patient Address")
  ListView1.Add("{PatientDistrict}", "Patient District")
  ListView1.Add("{PatientGender}", "Patient Gender")
  ListView1.Add("{PatientGuardian}", "Guardian")
  ListView1.Add("{PatientRelation}", "Patient Relation")
  ListView1.Add("{PatientAge}", "Current Age")
  ListView1.Add("{AgeGroup}", "Age Group")
  ListView1.Add("{E-Mail}", "E-Mail Address")
  ListView1.Add("AgeGroupCustom", "Custom Age Group")
  ListView1.Add("{ContactNo}", "Contact No")
  ListView1.Add("{Age/Sex}", "Age/Sex")
  ListView1.Add("{PatientDOB}", "Date of Birth")

  ListView1.Add("{PatientImage}", "Photograph")
  ListView1.Add("{PatientBarCode}", "Bar Code")
  ListView1.Add("{PatientQRCode}", "QR Code")

  ListView1.Add("{MotherEncounter}", "Mother Encounter ID")
  ListView1.Add("{MotherPatientNo}", "Mother Patient No")
  ListView1.Add("{MotherName}", "Mother Name")

  ListView1.Add("{ServiceType}", "Service Type")
  ListView1.Add("{ServiceRank}", "Service Rank")
  ListView1.Add("{ServiceUnit}", "Service Unit")

  ListView1.Add("c", "---Encounter Param ---")
  ListView1.Add("{DiscountPackae}", "Discount Package")
  ListView1.Add("{RegdDepartment}", "Regd Department")
  ListView1.Add("{RegdDeptRoom}", "Regd Department Room")
  ListView1.Add("{BedNo}", "Current Location")
  ListView1.Add("{WardName}", "Ward Name")
  ListView1.Add("{FirstWardName}", "First Ward Name")
  ListView1.Add("{CurrDepartment}", "Current Department")
  ListView1.Add("{WardCaption}", "Ward Label")
  ListView1.Add("{BedOxygen}", "Bed Oxygen")
  ListView1.Add("{BedVentilator}", "Ventilator")
  ListView1.Add("{RegdBillMode}", "Regd RatePlan")
  ListView1.Add("{VisitMode}", "Visit Mode")
  ListView1.Add("{CurrentStatus}", "Admission Status")
  ListView1.Add("{CurrentStatusComment}", "Status with Comment")
  ListView1.Add("{Consultant}", "Consultant")
  ListView1.Add("{RegdConsultationFree}", "RegdConsultation Free")

  ListView1.Add("{TotalExpense}", "Total Expense")
  ListView1.Add("{TotalPayment}", "Total Payment")
  ListView1.Add("{CurrentDeposit}", "Current Deposit")
  ListView1.Add("{NonInvoicedExpenses}", "Non-Invoiced Expenses")
  ListView1.Add("{BalanceDeposit}", "Balance Deposit")

  ListView1.Add("{LastInvoiceNumber}", "Last InvoiceNumber")
  ListView1.Add("{FirstInvoiceNumber}", "First InvoiceNumber")
  ListView1.Add("{FirstInvoiceAmount}", "First InvoiceAmount")
  ListView1.Add("{LastInvoiceAmount}", "Last InvoiceAmount")
  ListView1.Add("{FirstReceiptNumber}", "First ReceiptNumber")
  ListView1.Add("{LastReceiptNumber}", "Last ReceiptNumber")

  ListView1.Add("{LastInvReference}", "Last InvoiceReference")
  ListView1.Add("{FirstClaimCode}", "First Claim Code")
  ListView1.Add("{LastClaimCode}", "Last Claim Code")

  ListView1.Add("{RegistrationDate}", "Registration Date")
  ListView1.Add("{RegistrationTime}", "Registration Time")
  ListView1.Add("{AdmissionDate}", "Admission Date")
  ListView1.Add("{AdmissionTime}", "Admission Time")
  ListView1.Add("{DischargeDate}", "Discharge Date")
  ListView1.Add("{DischargeTime}", "Discharge Time")
  ListView1.Add("{ClearanceDateTime}", "Clearance Date")
  ListView1.Add("{AdmitDurationHour}", "Inpatient Duration")
  ListView1.Add("{FollowUpDate}", "Follow Up Date")
  ListView1.Add("{FollowUpTime}", "Follow Up Time")
  ListView1.Add("{ReferLocation}", "Refer Location")

  ListView1.Add("{RegistrationUser}", "Registration User")
  ListView1.Add("{AdmissionUser}", "Admission User")
  ListView1.Add("{DischargeUser}", "Discharge User")
  ListView1.Add("{ClearanceUser}", "Discharge Clearance")

  ListView1.Add("{FinalDiagnosis}", "Final Diagnosis")
  ListView1.Add("{ProvisionalDiagnosis}", "Provisional Diagnosis")
  ListView1.Add("{FinalDiagnosisClass}", "Final Diagnosis Class")
  ListView1.Add("{ProvisionalDiagnosisClass}", "Provisional Diagnosis Class")
  ListView1.Add("{PatientDiagnosis}", "Patient Diagnosis")
  ListView1.Add("{PatientDiagnosisClass}", "Patient Diagnosis Class")
  ListView1.Add("{PatientTriageColor}", "Triage Color")
  ListView1.Add("{PatientTriageSymbol}", "Triage Symbol")

  ListView1.Add("d", "---Consult Param ---")
  ListView1.Add("{LastConsultDept}", "LastConsultDept")
  ListView1.Add("{LastConsultRoom}", "LastConsultRoom")
  ListView1.Add("{LastConsultant}", "LastConsultant")
  ListView1.Add("{LastConsultBillMode}", "LastConsultBillMode")
  ListView1.Add("{LastConsultDate}", "LastConsultDate")
  ListView1.Add("{LastConsultTime}", "LastConsultTime")
  ListView1.Add("{LastConsultStatus}", "LastConsultStatus")
  ListView1.Add("{LastConsultComment}", "LastConsultComment")
  ListView1.Add("{LastConsultOutcome}", "LastConsultOutcome")
  ListView1.Add("{LastConsultQue}", "LastConsultQue")
  ListView1.Add("{LastOPVisitDept}", "LastOPVisitDept")
  ListView1.Add("{LastOPVisitRoom}", "LastOPVisitRoom")
  ListView1.Add("{LastOPVisitBillMode}", "LastOPVisitBillMode")
  ListView1.Add("{LastOPVisitDate}", "LastOPVisitDate")
  ListView1.Add("{LastOPVisitTime}", "LastOPVisitTime")
  ListView1.Add("{LastOPVisitStatus}", "LastOPVisitStatus")
  ListView1.Add("{LastOPVisitComment}", "LastOPVisitComment")
  ListView1.Add("{LastOPVisitOutcome}", "LastOPVisitOutcome")
  ListView1.Add("{LastVisitDate}", "LastVisitDate")
  ListView1.Add("{LastVisitTime}", "LastVisitTime")
  ListView1.Add("{LastVisitLocation}", "LastVisitLocation")

  ListView1.Add("e", "---Birth Param ---")
  ListView1.Add("{Birth_MotherEncID}", "Birth:MotherEncID")
  ListView1.Add("{Birth_MotherName}", "Birth:MotherName")
  ListView1.Add("{Birth_DeliveryDate}", "Birth:DeliveryDate")
  ListView1.Add("{Birth_DeliveryTime}", "Birth:DeliveryTime")
  ListView1.Add("{Birth_DeliveryType}", "Birth:DeliveryType")
  ListView1.Add("{Birth_DeliveryResult}", "Birth:DeliveryResult")
  ListView1.Add("{Birth_DeliveryConsult}", "Birth:DeliveryConsult")
  ListView1.Add("{Birth_BloodLoss}", "Birth:BloodLoss")
  ListView1.Add("{Birth_BabyWeight}", "Birth:BabyWeight")
  ListView1.Add("{Birth_BabyBirthCode}", "Birth:BabyCode")

  ListView1.Add("f", "---Procedure Param ---")
  ListView1.Add("{Procedure_Status}", "Procedure:Status")
  ListView1.Add("{Procedure_Name}", "Procedure:Name")
  ListView1.Add("{Procedure_Components}", "Procedure:Components")
  ListView1.Add("{Procedure_Summary}", "Procedure:Summary")
  ListView1.Add("{Procedure_Personnel}", "Procedure:Personnel")
  ListView1.Add("{Procedure_Comment}", "Procedure:Comment")

  ListView1.Add("{Procedure_PreOperative_Indication}", "Procedure:PreOperative_Indication")
  ListView1.Add("{Procedure_PreOperative_Comment}", "Procedure:PreOperative_Comment")
  ListView1.Add("{Procedure_PreOperative_Discussion}", "Procedure:PreOperative_Discussion")
  ListView1.Add("{Procedure_Anaesthesia_Technique}", "Procedure:Anaesthesia_Technique")
  ListView1.Add("{Procedure_Anaesthesia_Comment}", "Procedure:Anaesthesia_Comment")
  ListView1.Add("{Procedure_PostOperative_Indication}", "Procedure:PostOperative_Indication")
  ListView1.Add("{Procedure_PostOperative_Comment}", "Procedure:PostOperative_Comment")

  ListView1.Add("g", "---Diagnosis ---")
  ListView1.Add("{PresentingSymptoms}", "Presenting Complaints")
  ListView1.Add("{GeneralComplaints}", "General Complaints")

  ListView1.Add("{ClinicalFindings}", "Clinical Findings")
  ListView1.Add("{TriageExaminations}", "Triage Examinations")
  ListView1.Add("{EssentialExaminations}", "Essential Examinations")
  ListView1.Add("{PhysicianExaminations}", "Physician Examinations")
  ListView1.Add("{NursingExaminations}", "Nursing Examinations")
  ListView1.Add("{PhysicianStructured}", "Physician Structured")
  ListView1.Add("{DepartmentStructured}", "Department Structured")
  ListView1.Add("{DischargeExaminations}", "Discharge Examinations")

  ListView1.Add("{AdmissionCause}", "Cause of Admission")
  ListView1.Add("{HistoryofIllness}", "History of Illness")
  ListView1.Add("{PastHistory}", "Past History")
  ListView1.Add("{FamilyHistory}", "Family History")
  ListView1.Add("{TreatmentHistory}", "Treatment History")
  ListView1.Add("{MedicationHistory}", "Medication History")
  ListView1.Add("{PersonalHistory}", "Personal History")
  ListView1.Add("{SurgicalHistory}", "Surgical History")
  ListView1.Add("{OccupationalHistory}", "Occupational History")
  ListView1.Add("{SocialHistory}", "Social History")

  ListView1.Add("{InvestigationAdvised}", "Investigation Advised")
  ListView1.Add("{TreatmentAdvised}", "Treatment Advised")
  ListView1.Add("{SurgicalRequests}", "Surgical Request")
  ListView1.Add("{ExtraRequests}", "Extra Request")

  ListView1.Add("{OPDRecommendation}", "Initial Planning")
  ListView1.Add("{ExpertRecommendation}", "Final Planning")
  ListView1.Add("{DischargeOutcome}", "Outcome of Discharge")
  ListView1.Add("{DischargeMedicines}", "Discharge Medications")
  ListView1.Add("{DischargeCondition}", "Discharge Condition")
  ListView1.Add("{DischargeNote}", "Discharge Note")
  ListView1.Add("{CauseOfDeath}", "Cause of Death")
  ListView1.Add("{BSISummary}", "BSI Summary")
  ListView1.Add("{UTISummary}", "UTI Summary")

  ListView1.Add("h", "---Examination ---")
  ListView1.Add("{HepaticStatus}", "Hepatic Status")
  ListView1.Add("{PregnancyStatus}", "Pregnancy Status")
  ListView1.Add("{Weight}", "Weight(Kg)")
  ListView1.Add("{Height}", "Height(cm)")
  ListView1.Add("{Pulse_Rate}", "Pulse Rate")
  ListView1.Add("{Pulse_Rhythm}", "Pulse Rhythm")
  ListView1.Add("{BloodPressure_Systolic}", "Systolic BP")
  ListView1.Add("{BloodPressure_Diastolic}", "Diastolic BP")
  ListView1.Add("{BloodPressure_Systolic/Diastolic}", "Systolic/Diastolic BP")
  ListView1.Add("{Oxygen_Saturation}", "Oxygen Saturation")
  ListView1.Add("{Respiration_Rate}", "Respiration Rate")
  ListView1.Add("{Temperature_System}", "Temperature")

  ListView1.Add("i", "---Supplier Details ---")
  ListView1.Add("{SupplierName}", "Name")
  ListView1.Add("{SupplierAddress}", "Address")
  ListView1.Add("{SupplierPAN}", "PAN")
  ListView1.Add("{SupplierLedger}", "Ledger")
  ListView1.Add("{SupplierContact}", "Phone")
  ListView1.Add("{SupplierEMail}", "E-Mail")
  ListView1.Add("{SupplierUserName}", "Rep Name")
  ListView1.Add("{SupplierUserContact}", "Rep Phone")

  ListView1.Add("j", "---Purchase Entry ---")
  ListView1.Add("{PurchaseReferenceNo}", "Entry Reference No")
  ListView1.Add("{PurchaseReferenceDate}", "Entry Reference Date")
  ListView1.Add("{PurchaseReferenceUser}", "Entry Reference User")
  ListView1.Add("{PurchaseInvoiceNumber}", "Purchase Invoice No")
  ListView1.Add("{PurchaseInvoiceDate}", "Purchase Invoice Date")
  ListView1.Add("{PurchasePaymentType}", "Purchase Payment Type")

  ListView1.Add("k", "---Purchase Order ---")
  ListView1.Add("{PurchaseRequestNo}", "Purchase Order No")
  ListView1.Add("{PurchaseRequestDate}", "Purchase Order Date")
  ListView1.Add("{PurchaseRequestUser}", "Purchase Order User")
  ListView1.Add("{PurchaseRequestDelivery}", "Purchase Delivery Date")
  ListView1.Add("{PurchaseRequestVerifyUser}", "Order Verify User")
  ListView1.Add("{PurchaseRequestVerifyDate}", "Order Verify Date")

  ListView1.Add("l", "---Store Request ---")
  ListView1.Add("{StoreRequestNo}", "Store Request No")
  ListView1.Add("{StoreRequestDate}", "Store Request Date")
  ListView1.Add("{StoreRequestingComp}", "Store Request By")
  ListView1.Add("{StoreRequestEntryUser}", "Store Request User")
  ListView1.Add("{StoreRequestedComp}", "Store Request From")
  ListView1.Add("{StoreRequestVerifyUser}", "Request Verify User")
  ListView1.Add("{StoreRequestVerifyDate}", "Request Verify Date")

End

Public Sub ListView1_Click()

  TextEdit1.RichText = TextEdit1.RichText & ListView1.Key
  TextEdit1.SetFocus

End

Public Sub btndiagno_Click()

  TextEdit1.Text = TextEdit1.Text & VarDiagnostic()

End
